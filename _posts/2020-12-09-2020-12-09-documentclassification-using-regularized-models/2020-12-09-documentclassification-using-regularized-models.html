<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #545454; font-weight: bold; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #a1024a; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007faa; font-weight: bold; } /* ControlFlow */
code span.ch { color: #008000; } /* Char */
code span.cn { color: #d91e18; } /* Constant */
code span.co { color: #545454; } /* Comment */
code span.cv { color: #545454; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #aa5d00; } /* DataType */
code span.dv { color: #a1024a; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #a1024a; } /* Float */
code span.fu { color: #4254a7; } /* Function */
code span.im { } /* Import */
code span.in { color: #545454; font-weight: bold; } /* Information */
code span.kw { color: #007faa; font-weight: bold; } /* Keyword */
code span.op { color: #696969; } /* Operator */
code span.ot { color: #007faa; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #008000; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #008000; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #008000; } /* VerbatimString */
code span.wa { color: #545454; font-weight: bold; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>Classifying abstracts using regularized models: covid-19 or sars-2003?</title>
  
  <meta property="description" itemprop="description" content="Classifying abstracts using regularized models: covid-19 or sars-2003?"/>
  
  
  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2021-01-16"/>
  <meta property="article:created" itemprop="dateCreated" content="2021-01-16"/>
  <meta name="article:author" content="Mihiretu Kebede(PhD)"/>
  
  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="Classifying abstracts using regularized models: covid-19 or sars-2003?"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="Classifying abstracts using regularized models: covid-19 or sars-2003?"/>
  <meta property="og:locale" content="en_US"/>
  
  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="Classifying abstracts using regularized models: covid-19 or sars-2003?"/>
  <meta property="twitter:description" content="Classifying abstracts using regularized models: covid-19 or sars-2003?"/>
  
  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","url","google_analytics","description","preview","collections","output","date"]}},"value":[{"type":"character","attributes":{},"value":["Classifying abstracts using regularized models: covid-19 or sars-2003?"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Mihiretu Kebede(PhD)"]}]}]},{"type":"character","attributes":{},"value":["http://www.mihiretukebede.com/"]},{"type":"character","attributes":{},"value":["UA-173027539-1"]},{"type":"character","attributes":{},"value":["Classifying abstracts using regularized models: covid-19 or sars-2003? \n"]},{"type":"character","attributes":{},"value":["lasso.jpeg"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["posts"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["share"]}},"value":[{"type":"character","attributes":{},"value":["twitter","linkedin","facebook","google-plus","pinterest"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","widerscreen"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["01-16-2021"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2020-12-09-documentclassification-using-regularized-models_files/anchor-4.2.2/anchor.min.js","2020-12-09-documentclassification-using-regularized-models_files/bowser-1.9.3/bowser.min.js","2020-12-09-documentclassification-using-regularized-models_files/distill-2.2.21/template.v2.js","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-10-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-11-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-14-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-16-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-17-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-19-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-20-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-26-1.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-26-2.png","2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-8-1.png","2020-12-09-documentclassification-using-regularized-models_files/header-attrs-2.5/header-attrs.js","2020-12-09-documentclassification-using-regularized-models_files/jquery-1.11.3/jquery.min.js","2020-12-09-documentclassification-using-regularized-models_files/webcomponents-2.0.0/webcomponents.js","covidsars.xlsx","lasso.JPG"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->
  
  <style type="text/css">
  
  body {
    background-color: white;
  }
  
  .pandoc-table {
    width: 100%;
  }
  
  .pandoc-table>caption {
    margin-bottom: 10px;
  }
  
  .pandoc-table th:not([align]) {
    text-align: left;
  }
  
  .pagedtable-footer {
    font-size: 15px;
  }
  
  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }
  
  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }
  
  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }
  
  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }
  
  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }
  
  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }
  
  .html-widget {
    margin-bottom: 2.0em;
  }
  
  .l-screen-inset {
    padding-right: 16px;
  }
  
  .l-screen .caption {
    margin-left: 10px;
  }
  
  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .shaded .shaded-content {
    background: white;
  }
  
  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }
  
  .hidden {
    display: none !important;
  }
  
  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }
  
  d-appendix {
    padding-top: 30px;
  }
  
  d-article>p>img {
    width: 100%;
  }
  
  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }
  
  d-article h3 {
    margin-top: 1.5rem;
  }
  
  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }
  
  /* Tweak code blocks */
  
  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: hidden;
  }
  
  d-article div.sourceCode {
    background-color: white;
  }
  
  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }
  
  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  d-article pre a {
    border-bottom: none;
  }
  
  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }
  
  @media(min-width: 768px) {
  
  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }
  
  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }
  
  d-article pre {
    font-size: 14px;
  }
  
  }
  
  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  /* CSS for d-contents */
  
  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }
  
  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }
  
  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }
  
  .d-contents li {
    list-style-type: none
  }
  
  .d-contents nav > ul {
    padding-left: 0;
  }
  
  .d-contents ul {
    padding-left: 1em
  }
  
  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }
  
  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }
  
  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }
  
  .d-contents nav > ul > li > a {
    font-weight: 600;
  }
  
  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }
  
  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }
  
  
  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }
  
  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }
  
  
  /* Figure */
  
  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }
  
  .figure img {
    width: 100%;
  }
  
  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }
  
  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }
  
  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }
  
  /* Citations */
  
  d-article .citation {
    color: inherit;
    cursor: inherit;
  }
  
  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }
  
  
  /* Tweak 1000px media break to show more text */
  
  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }
  
    .grid {
      grid-column-gap: 16px;
    }
  
    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }
  
  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }
  
    .grid {
      grid-column-gap: 32px;
    }
  }
  
  
  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */
  
  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  
  /* Include appendix styles here so they can be overridden */
  
  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }
  
  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }
  
  d-appendix h3 + * {
    margin-top: 1em;
  }
  
  d-appendix ol {
    padding: 0 0 0 15px;
  }
  
  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }
  
  d-appendix li {
    margin-bottom: 1em;
  }
  
  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }
  
  d-appendix > * {
    grid-column: text;
  }
  
  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }
  
  /* Include footnote styles here so they can be overridden */
  
  d-footnote-list {
    contain: layout style;
  }
  
  d-footnote-list > * {
    grid-column: text;
  }
  
  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }
  
  
  
  /* Anchor.js */
  
  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }
  
  /* Social footer */
  
  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }
  
  .disqus-comments {
    margin-right: 30px;
  }
  
  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }
  
  #disqus_thread {
    margin-top: 30px;
  }
  
  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }
  
  .article-sharing a:hover {
    border-bottom: none;
  }
  
  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .subscribe p {
    margin-bottom: 0.5em;
  }
  
  
  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }
  
  
  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }
  
  .custom p {
    margin-bottom: 0.5em;
  }
  
  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }
  
  /* Styles for posts lists (not auto-injected) */
  
  
  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }
  
  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }
  
  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }
  
  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }
  
  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }
  
  .post-preview-last {
    border-bottom: none !important;
  }
  
  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }
  
  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }
  
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }
  
  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }
  
  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }
  
  .posts-list .metadata > * {
    display: inline-block;
  }
  
  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }
  
  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }
  
  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }
  
  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }
  
  .posts-list img {
    opacity: 1;
  }
  
  .posts-list img[data-src] {
    opacity: 0;
  }
  
  .posts-more {
    clear: both;
  }
  
  
  .posts-sidebar {
    font-size: 16px;
  }
  
  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }
  
  .sidebar-section {
    margin-bottom: 30px;
  }
  
  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
  
  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }
  
  .categories li>a {
    border-bottom: none;
  }
  
  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }
  
  .categories .active {
    font-weight: 600;
  }
  
  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }
  
  
  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }
  
  
  /* Improve display for browsers without grid (IE/Edge <= 15) */
  
  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }
  
  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }
  
  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }
  
  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }
  
  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }
  
  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }
  
  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }
  
  
  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }
  
  .downlevel .footnotes ol {
    padding-left: 13px;
  }
  
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }
  
  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }
  
  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }
  
  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
  
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
  
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }
  
  .downlevel .posts-list .post-preview {
    color: inherit;
  }
  
  
  
  </style>
  
  <script type="application/javascript">
  
  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }
  
  // show body when load is complete
  function on_load_complete() {
  
    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }
  
  
    // set body to visible
    document.body.style.visibility = 'visible';
  
    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }
  
    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }
  
  function init_distill() {
  
    init_common();
  
    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);
  
    // create d-title
    $('.d-title').changeElementType('d-title');
  
    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);
  
    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();
  
    // move posts container into article
    $('.posts-container').appendTo($('d-article'));
  
    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');
  
    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;
  
    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();
  
    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));
  
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });
  
    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');
  
    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {
  
      // capture layout
      var layout = $(this).attr('data-layout');
  
      // apply layout to markdown level block elements
      var elements = $(this).children().not('div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });
  
  
      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });
  
    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();
  
    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();
  
    // load distill framework
    load_distill_framework();
  
    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {
  
      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;
  
      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');
  
      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');
  
      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');
  
      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });
  
      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }
  
      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');
  
      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");
  
      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }
  
       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }
  
      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();
  
      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();
  
      // clear polling timer
      clearInterval(tid);
  
      // show body now that everything is ready
      on_load_complete();
    }
  
    var tid = setInterval(distill_post_process, 50);
    distill_post_process();
  
  }
  
  function init_downlevel() {
  
    init_common();
  
     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));
  
    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
  
    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();
  
    // remove toc
    $('.d-contents').remove();
  
    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });
  
  
    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);
  
    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);
  
    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();
  
    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();
  
    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));
  
    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });
  
    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));
  
    $('body').addClass('downlevel');
  
    on_load_complete();
  }
  
  
  function init_common() {
  
    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};
  
        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });
  
        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);
  
    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});
  
    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });
  
      }
    });
  
    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });
  
    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }
  
    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');
  
    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");
  
    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();
  
    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }
  
  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });
  
  </script>
  
  <!--/radix_placeholder_distill-->
  <script src="2020-12-09-documentclassification-using-regularized-models_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="2020-12-09-documentclassification-using-regularized-models_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="2020-12-09-documentclassification-using-regularized-models_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="2020-12-09-documentclassification-using-regularized-models_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="2020-12-09-documentclassification-using-regularized-models_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Classifying abstracts using regularized models: covid-19 or sars-2003?","description":"Classifying abstracts using regularized models: covid-19 or sars-2003?","authors":[{"author":"Mihiretu Kebede(PhD)","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-01-16T00:00:00.000+01:00","citationText":"Kebede(PhD), 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Classifying abstracts using regularized models: covid-19 or sars-2003?</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Classifying abstracts using regularized models: covid-19 or sars-2003?</p></p>
</div>

<div class="d-byline">
  
  Mihiretu Kebede(PhD)
  
<br/>01-16-2021
</div>

<div class="d-article">
<h1 id="introduction">Introduction</h1>
<p>Classifying documents to a certain list of categories can provide valuable insights and possibly make the documents more manageable. Document classification is one of the application areas of machine learning. Natural Language Processing(NLP) and machine learning methods can be used to automate classification of documents such as emails(ham/spam categories), articles, books, response to survey questions, sentiments, product reviews(negative/positive), etc.</p>
<p>There are handful of very good algorithms that can automagically handle text data. In this blog post, I would like to experiment regularized logistic regression machine learning models for classifying abstracts.</p>
<p>I am interested in predicting abstracts that will fall into “SARS_2003” and “COVID_19” categories. For this task, I will use the same data sets that I have used in my previous blog posts. I saved the references files in excel from my previous post. I will simply load this excel file and play with the abstract using <code>qunateda</code> and <code>glmnet</code> packages. 😍</p>
<h1 id="data">Data</h1>
<p>I load the data and see a summary of number of characters used to write the abstracts. For this analysis, I will use only abstracts having 200 characters. I will just filter out the abstracts on the lower side of the extreme.</p>
<h1 id="check-number-of-covidsars-papers">Check number of covid/sars papers</h1>
<p>The covid abstracts were originally labeled as “included” and sars abstracts as “excluded”. I will simply create a category variable and change the labels to “covid” or “sars”. About 52% of the abstracts have “covid” labels the remaining is “sars”.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span> <span class='op'>&lt;-</span> <span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>Include</span>
<span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>[</span><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>==</span><span class='st'>"included"</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='st'>"covid"</span>
<span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>[</span><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>==</span><span class='st'>"not included"</span><span class='op'>]</span><span class='op'>&lt;-</span><span class='st'>"sars"</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
covid  sars 
  506   464 </code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>100</span>, <span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
covid  sars 
 52.2  47.8 </code></pre>
</div>
<h1 id="split-the-data">Split the data</h1>
<p>Before we do any steps in a text analysis, it is recommended to split the data. Splitting the data after tokenization is not a good approach. So, we will instead split the data into train and test set, tokenize the train and test sets separately, build models, match the variables of the test data set with the train. Finally, we will predict the test data and then evaluate our predictions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span> <span class='co'>#For splitting </span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1234</span><span class='op'>)</span>

<span class='va'>trainIndex</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/createDataPartition.html'>createDataPartition</a></span><span class='op'>(</span><span class='va'>covid_sars</span><span class='op'>$</span><span class='va'>category</span>, p <span class='op'>=</span> <span class='fl'>.8</span>, 
                                  list <span class='op'>=</span> <span class='cn'>FALSE</span>, 
                                  times <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>

<span class='va'>train</span> <span class='op'>&lt;-</span> <span class='va'>covid_sars</span><span class='op'>[</span><span class='va'>trainIndex</span>,<span class='op'>]</span>
<span class='va'>test</span>  <span class='op'>&lt;-</span> <span class='va'>covid_sars</span><span class='op'>[</span><span class='op'>-</span><span class='va'>trainIndex</span>,<span class='op'>]</span>

<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
covid  sars 
  405   372 </code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>
covid  sars 
  101    92 </code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 777</code></pre>
</div>
<h1 id="text-analysis">Text analysis</h1>
<p>If you are interested in text analysis, I reccommend visiting Quanteda website. Quanteda is a great package for text analysis. One of the great advantage of quanteda is it is super fast, have so many powerful functions. I have tried five different R packages for text data. Based on my personal taste, I would rank them as follows: Quanteda, txt2vec, tidytext, tm.</p>
<h2 id="create-corpus">Create Corpus</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://quanteda.io'>quanteda</a></span><span class='op'>)</span>

<span class='co'>#Train data</span>
<span class='va'>tr</span> <span class='op'>&lt;-</span> <span class='va'>train</span><span class='op'>[</span>, <span class='fl'>6</span><span class='op'>]</span> <span class='co'># the sixth variable is unique label. I will use it as identifier. </span>
<span class='va'>traincorpus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/corpus.html'>corpus</a></span><span class='op'>(</span><span class='va'>train</span><span class='op'>$</span><span class='va'>abstract</span>,
                      docvars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>trainvars<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>tr</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'>#Test data</span>
<span class='va'>ts</span> <span class='op'>&lt;-</span> <span class='va'>test</span><span class='op'>[</span>, <span class='fl'>6</span><span class='op'>]</span>

<span class='va'>testcorpus</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/corpus.html'>corpus</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>abstract</span>,
                     docvars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>testvars<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>ts</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>traincorpus</span>,<span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Corpus consisting of 777 documents, showing 2 documents:

  Text Types Tokens Sentences trainvars
 text1   165    337        11     label
 text2    94    164         5     label</code></pre>
<div class="sourceCode">
<pre><code><span class='co'># Connect the labels with the corpuses</span>
<span class='va'>docid_train</span> <span class='op'>&lt;-</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>label</span>

<span class='fu'><a href='https://quanteda.io/reference/docnames.html'>docnames</a></span><span class='op'>(</span><span class='va'>traincorpus</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>docid_train</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>traincorpus</span>,<span class='fl'>1</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Corpus consisting of 1 document and 1 docvar.
Ataguba2020 :
&quot;The coronavirus disease 2019 (COVID-19) pandemic has affecte...&quot;</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>docid_test</span> <span class='op'>&lt;-</span> <span class='va'>test</span><span class='op'>$</span><span class='va'>label</span>
<span class='fu'><a href='https://quanteda.io/reference/docnames.html'>docnames</a></span><span class='op'>(</span><span class='va'>testcorpus</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>docid_test</span>

<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>testcorpus</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Corpus consisting of 193 documents, showing 2 documents:

         Text Types Tokens Sentences testvars
   Coccia2020   264    782        12    label
 Cagliani2020   182    337        16    label</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>traincorpus</span>, <span class='fl'>4</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Corpus consisting of 777 documents, showing 4 documents:

        Text Types Tokens Sentences trainvars
 Ataguba2020   165    337        11     label
  Sigala2020    94    164         5     label
 Lechner2020   103    160         7     label
    Okba2020   118    176         6     label</code></pre>
</div>
<h1 id="tokenize">Tokenize</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>traintokens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/tokens.html'>tokens</a></span><span class='op'>(</span><span class='va'>traincorpus</span>,
                      remove_punct <span class='op'>=</span> <span class='cn'>TRUE</span>,
                      remove_url <span class='op'>=</span> <span class='cn'>TRUE</span>,
                      remove_numbers <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>traintokens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/tokens_select.html'>tokens_remove</a></span><span class='op'>(</span><span class='va'>traintokens</span>, 
                             pattern<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/stopwords/man/stopwords.html'>stopwords</a></span><span class='op'>(</span><span class='st'>'en'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>testtokens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/tokens.html'>tokens</a></span><span class='op'>(</span><span class='va'>testcorpus</span>,
                     remove_punct <span class='op'>=</span> <span class='cn'>TRUE</span>,
                     remove_url <span class='op'>=</span> <span class='cn'>TRUE</span>,
                     remove_numbers <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>testtokens</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/tokens_select.html'>tokens_remove</a></span><span class='op'>(</span><span class='va'>testtokens</span>, 
                             pattern<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/stopwords/man/stopwords.html'>stopwords</a></span><span class='op'>(</span><span class='st'>'en'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="construct-the-dfm-objects">Construct the DFM objects</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>dfmat_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm.html'>dfm</a></span><span class='op'>(</span><span class='va'>traintokens</span><span class='op'>)</span>

<span class='va'>dfmat_test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm.html'>dfm</a></span><span class='op'>(</span><span class='va'>testtokens</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dfmat_train</span>,<span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Document-feature matrix of: 2 documents, 12,119 features (99.2% sparse) and 1 docvar.
             features
docs          coronavirus disease covid-19 pandemic affected many
  Ataguba2020           2       2        6        3        1    7
  Sigala2020            0       0        4        1        0    0
             features
docs          countries increasing morbidity mortality
  Ataguba2020         7          1         2         1
  Sigala2020          0          0         0         0
[ reached max_nfeat ... 12,109 more features ]</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dfmat_test</span>,<span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Document-feature matrix of: 2 documents, 5,484 features (97.0% sparse) and 1 docvar.
              features
docs           study two goals first explain geo-environmental
  Coccia2020       3   1     1     1       1                 1
  Cagliani2020     0   0     0     0       0                 0
              features
docs           determinants accelerated diffusion covid-19
  Coccia2020              1           3         3        9
  Cagliani2020            0           0         0        0
[ reached max_nfeat ... 5,474 more features ]</code></pre>
</div>
<p>The training data has 12,119 features and is 99.2% sparse, while the test data has 5,484 features and 97% sparsity. I will not do anything to reduce the sparsity. But, you may have to do it if you have a large number of observations. Quanteda’s dfm_trim() can do that for you.</p>
<p>TF-IDF weighting is known to improve prediction performance. I will use that here too.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>dfmat_train_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm_tfidf.html'>dfm_tfidf</a></span><span class='op'>(</span><span class='va'>dfmat_train</span><span class='op'>)</span>
<span class='va'>dfmat_test_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm_tfidf.html'>dfm_tfidf</a></span><span class='op'>(</span><span class='va'>dfmat_test</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let’s inspect the two tfidf data that were created above.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dfmat_train_tfidf</span>, <span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Document-feature matrix of: 2 documents, 12,119 features (99.2% sparse) and 1 docvar.
             features
docs          coronavirus   disease covid-19  pandemic affected
  Ataguba2020     0.86811 0.8990239 2.287311 1.8627242 1.182851
  Sigala2020      0       0         1.524874 0.6209081 0       
             features
docs              many countries increasing morbidity mortality
  Ataguba2020 7.450424  6.911317   1.475448  3.319944  1.126993
  Sigala2020  0         0          0         0         0       
[ reached max_nfeat ... 12,109 more features ]</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>dfmat_test_tfidf</span>,<span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Document-feature matrix of: 2 documents, 5,484 features (97.0% sparse) and 1 docvar.
              features
docs              study      two    goals     first  explain
  Coccia2020   1.659491 0.870584 1.808436 0.7057737 1.984527
  Cagliani2020 0        0        0        0         0       
              features
docs           geo-environmental determinants accelerated diffusion
  Coccia2020            2.285557     2.285557    5.953582  5.425308
  Cagliani2020          0            0           0         0       
              features
docs           covid-19
  Coccia2020   3.642693
  Cagliani2020 0       
[ reached max_nfeat ... 5,474 more features ]</code></pre>
</div>
<h1 id="model-building">Model building</h1>
<h2 id="why-not-logistic-regression">Why not logistic regression?</h2>
<p>My data has two class labels(covid vs sars) and all numerical features. Why not logistic regression, then? Well, linear models provide great approaches to predictive modeling given that the assumptions are met! These assumptions (for example: hemoscidascity of variance) are violated when we have more number of features than observations (For example in genetics studies and text analysis, this is often the case). Applying linear models to such data results in biased coefficients, weaker prediction performance scores, overfitting or high out of sample prediction error problems. Hence, penalizing the estimated model coefficients was devised. This method of penalizing linear models is called “Regularization”. There are three most commonly used approaches to regularization for logistic regression: Ridge, LASSO, and Elastic net.</p>
<p>In Ridge penalty, the estimated model coefficients are penalized by adding the following parameter. SSE <span class="math display">\[\begin{equation}
\ SSE = \sum^n_{i=1} \left(y_i - \hat{y}_i\right)^2 
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation} \ SSE + \lambda \sum^p_{j=1} \beta_j^2 \
\end{equation}\]</span></p>
<p>This is called L^2 norm. From the above equation if lambda equals 0, the model will be equal to the ordinary least squares model. As approaches to infinity, the penalty will force the model coefficients to be closer to zero but not completely to 0. Ridge penalty is known to systematically handling highly correlated features. In Lasso penalty the model coefficients are penalized by a L1 norm as follows. <span class="math display">\[\begin{equation}SSE + \lambda \sum^p_{j=1} | \beta_j |
\end{equation}\]</span></p>
<p>Lasso penalty unlike ridge pushes all the coefficients all the way to zero. The advantage of Lasso is it improves model performance while also automating feature selection. Only the features that are important will be retianed on the final model.</p>
<p>Elastic net combines both Lasso and Ridge penalty parameters. Elastic net takes advantages of both Lasso and Ridge penalty: effective regularization by automated feature selection as well as effectively handling correlated features.</p>
<h1 id="implementations">Implementations</h1>
<p>Probably the most popular package to implement regualrized models is the <code>glmnet</code> package. This package is lightening fast to tune cross validated models. I watched one very nice webinar tutorial from Dr Trevor Hastie(one of the authors of this package). He mentioned that it is fast because it is programmed in Fortran. I invite you to watch that great <a href="https://www.youtube.com/watch?v=BU2gjoLPfDc&amp;t=2592s&amp;ab_channel=ProfTrevorHastie">webinar here</a> I head I heard there are also other packages like <code>H2O</code> and <code>elastic net</code>. I have never tried any of them.</p>
<p>For regularized models, we have two main tuning parameters: alpha and lambda. In ridge and Lasso the lambda is the only tuning parameter but alpha is set to be 0 and 1, respectively. For tuning lambda, the cv.glmnet() function provides 100 different data driven lambda values and there is no need to do anything else. Since elastic net combines both Lasso and Ridge penalty, we will have two tuning parameters: alpha and lambda. Alpha can take a number values between between 0 and 1, while lambda can have 100 different data driven lambda values by just using <code>cv.glmnet()</code> function.</p>
<p>All models require the data to be in a matrix form. The good thing with quanteda is the document feature matrix is already a matrix object we don’t need to change the structure of our data. Notice the time required to tune the cross-validated algorithms.</p>
<h1 id="ridge">Ridge</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Ridge regression</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://glmnet.stanford.edu'>glmnet</a></span><span class='op'>)</span>
<span class='va'>ridge_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dfmat_train</span>, y <span class='op'>=</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>0</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>
<span class='co'>#tfidf</span>
<span class='va'>ridge_1_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dfmat_train_tfidf</span>, y <span class='op'>=</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>0</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_1</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Ridge penalty\n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_1_tfidf</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Ridge penalty tfidf\n\n"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-8-1.png" width="975" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>ridge_min</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>dfmat_train</span>,
                   y<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>,
                   family<span class='op'>=</span><span class='st'>"binomial"</span>, 
                   alpha<span class='op'>=</span><span class='fl'>0</span>,  <span class='co'># alpha = 0 for ridge regression</span>
                   parallel<span class='op'>=</span><span class='cn'>TRUE</span>, 
                   intercept<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Again using the tf-idf weighted data</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>ridge_min_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>dfmat_train_tfidf</span>,
                   y<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>,
                   family<span class='op'>=</span><span class='st'>"binomial"</span>, 
                   alpha<span class='op'>=</span><span class='fl'>0</span>,  <span class='co'># alpha = 0 for ridge regression</span>
                   parallel<span class='op'>=</span><span class='cn'>TRUE</span>, 
                   intercept<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_min</span>, main<span class='op'>=</span><span class='st'>"Ridge penalty\n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_min_tfidf</span>, main<span class='op'>=</span><span class='st'>"Ridge penalty_tfidf\n\n"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-10-1.png" width="975" />
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span> <span class='va'>x</span>
</code></pre>
</div>
<pre><code>Time difference of 23.83476 secs</code></pre>
</div>
<p>Let’s plot the results</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_1</span>, xvar <span class='op'>=</span> <span class='st'>"lambda"</span>, main <span class='op'>=</span> <span class='st'>"Ridge penalty\n\n"</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ridge_min</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, lty <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ridge_min</span><span class='op'>$</span><span class='va'>lambda.1se</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>, lty <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>ridge_1_tfidf</span>, xvar <span class='op'>=</span> <span class='st'>"lambda"</span>, main <span class='op'>=</span> <span class='st'>"Ridge penalty tfidf\n\n"</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ridge_min_tfidf</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"red"</span>, lty <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>ridge_min_tfidf</span><span class='op'>$</span><span class='va'>lambda.1se</span><span class='op'>)</span>, col <span class='op'>=</span> <span class='st'>"blue"</span>, lty <span class='op'>=</span> <span class='st'>"dashed"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-11-1.png" width="975" data-distill-preview=1 /></p>
</div>
<h1 id="predict-the-test-data-sets">Predict the test data sets</h1>
<p>Before we predict the test data, we need to do one very key step. We will predict the test data based on the data that the model was trained. So, features on the test data should match with the features on the training data. Otherwise, the prediction will not work. The model cannot understand anything outside of the features that were in the training data. This is very key step in text prediction. Quanteda provides a nice function for that: dfm_match(). It subsets the features of the test data that were part of the training data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>dfmat_matched</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm_match.html'>dfm_match</a></span><span class='op'>(</span><span class='va'>dfmat_test</span>, 
                           features <span class='op'>=</span> <span class='fu'><a href='https://quanteda.io/reference/featnames.html'>featnames</a></span><span class='op'>(</span><span class='va'>dfmat_train</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Match the tfi-idf</span>
<span class='va'>dfmat_matched_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://quanteda.io/reference/dfm_match.html'>dfm_match</a></span><span class='op'>(</span><span class='va'>dfmat_test_tfidf</span>, 
                                 features <span class='op'>=</span> <span class='fu'><a href='https://quanteda.io/reference/featnames.html'>featnames</a></span><span class='op'>(</span><span class='va'>dfmat_train_tfidf</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>For prediction, I will use the best model from the cross validated models. The best model lies between the model having the minimum lamda value and the model that has a lambda value within 1 se. Here, I will use the minimum lamda value.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Predict </span>
<span class='va'>ridge_min</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train, y = train$category, parallel = TRUE,      family = &quot;binomial&quot;, alpha = 0, intercept = TRUE) 

Measure: Binomial Deviance 

    Lambda Measure      SE Nonzero
min  3.060   1.023 0.01754   12119
1se  3.518   1.040 0.01666   12119</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>ridge_min</span><span class='op'>$</span><span class='va'>lambda.1se</span>
</code></pre>
</div>
<pre><code>[1] 3.518117</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>ridge_min</span><span class='op'>$</span><span class='va'>lambda.min</span>
</code></pre>
</div>
<pre><code>[1] 3.059879</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>actual_class</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
<span class='va'>predicted_class.ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge_min</span>, newx<span class='op'>=</span><span class='va'>dfmat_matched</span>,s<span class='op'>=</span><span class='st'>"lambda.min"</span>, type<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span>

<span class='va'>tab_class.ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>predicted_class.ridge</span>, <span class='va'>actual_class</span><span class='op'>)</span>

<span class='va'>confusionmatrix_ridge</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>tab_class.ridge</span>, mode<span class='op'>=</span><span class='st'>"everything"</span>, positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span>


<span class='co'>##tfidf</span>
<span class='va'>ridge_min_tfidf</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train_tfidf, y = train$category, parallel = TRUE,      family = &quot;binomial&quot;, alpha = 0, intercept = TRUE) 

Measure: Binomial Deviance 

    Lambda Measure      SE Nonzero
min  3.060   1.023 0.01754   12119
1se  3.518   1.040 0.01666   12119</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>ridge_min_tfidf</span><span class='op'>$</span><span class='va'>lambda.1se</span>
</code></pre>
</div>
<pre><code>[1] 3.518117</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>ridge_min_tfidf</span><span class='op'>$</span><span class='va'>lambda.min</span>
</code></pre>
</div>
<pre><code>[1] 3.059879</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>actual_class_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
<span class='va'>predicted_class.ridge_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>ridge_min_tfidf</span>, newx<span class='op'>=</span><span class='va'>dfmat_matched_tfidf</span>, s<span class='op'>=</span><span class='st'>"lambda.min"</span>, type<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span>

<span class='va'>tab_class.ridge_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>predicted_class.ridge_tfidf</span>, <span class='va'>actual_class</span><span class='op'>)</span>

<span class='va'>confusionmatrix_ridge_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>tab_class.ridge_tfidf</span>, mode<span class='op'>=</span><span class='st'>"everything"</span>, positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span>

<span class='va'>confusionmatrix_ridge</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

                     actual_class
predicted_class.ridge covid sars
                covid    85   17
                sars     16   75
                                          
               Accuracy : 0.829           
                 95% CI : (0.7683, 0.8793)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6571          
                                          
 Mcnemar&#39;s Test P-Value : 1               
                                          
            Sensitivity : 0.8416          
            Specificity : 0.8152          
         Pos Pred Value : 0.8333          
         Neg Pred Value : 0.8242          
              Precision : 0.8333          
                 Recall : 0.8416          
                     F1 : 0.8374          
             Prevalence : 0.5233          
         Detection Rate : 0.4404          
   Detection Prevalence : 0.5285          
      Balanced Accuracy : 0.8284          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
<div class="sourceCode">
<pre><code><span class='va'>confusionmatrix_ridge_tfidf</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

                           actual_class
predicted_class.ridge_tfidf covid sars
                      covid    86   17
                      sars     15   75
                                          
               Accuracy : 0.8342          
                 95% CI : (0.7741, 0.8837)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt;2e-16          
                                          
                  Kappa : 0.6673          
                                          
 Mcnemar&#39;s Test P-Value : 0.8597          
                                          
            Sensitivity : 0.8515          
            Specificity : 0.8152          
         Pos Pred Value : 0.8350          
         Neg Pred Value : 0.8333          
              Precision : 0.8350          
                 Recall : 0.8515          
                     F1 : 0.8431          
             Prevalence : 0.5233          
         Detection Rate : 0.4456          
   Detection Prevalence : 0.5337          
      Balanced Accuracy : 0.8334          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
</div>
<p>See, all features are retained in the final models. Looking at the prediction performances of the two, we can see that the tfidf-weighted data has better performance. We will try Lasso if we can improve that.</p>
<h1 id="lasso-penalty">Lasso penalty</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## Lasso model</span>
<span class='va'>lasso_1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dfmat_train</span>, y <span class='op'>=</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>1</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span>, type.measure<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span> 

<span class='va'>lasso_1_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/glmnet.html'>glmnet</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>dfmat_train</span>, y <span class='op'>=</span> <span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                    alpha <span class='op'>=</span> <span class='fl'>1</span>, family <span class='op'>=</span> <span class='st'>"binomial"</span>, type.measure<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span> 

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso_1</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Lasso penalty\n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso_1_tfidf</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Lasso penalty tfidf\n\n"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-14-1.png" width="975" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='co'>#registerDoMC(cores=2) # parallelize to speed up</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>dfmat_train</span>,
                   y<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>,
                   family<span class='op'>=</span><span class='st'>"binomial"</span>, 
                   alpha<span class='op'>=</span><span class='fl'>1</span>,  <span class='co'># alpha = 1: LASSO</span>
                   parallel<span class='op'>=</span><span class='cn'>TRUE</span>, nfolds <span class='op'>=</span> <span class='fl'>10</span>,
                   intercept<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> 

<span class='co'># tfidf</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span>
<span class='va'>lasso_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://glmnet.stanford.edu/reference/cv.glmnet.html'>cv.glmnet</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>dfmat_train_tfidf</span>,
                   y<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>,
                   family<span class='op'>=</span><span class='st'>"binomial"</span>, 
                   alpha<span class='op'>=</span><span class='fl'>1</span>,  <span class='co'># alpha = 1: LASSO</span>
                   parallel<span class='op'>=</span><span class='cn'>TRUE</span>, nfolds <span class='op'>=</span> <span class='fl'>10</span>,
                   intercept<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>-</span><span class='va'>x</span> 
</code></pre>
</div>
<pre><code>Time difference of 5.816915 secs</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train, y = train$category, nfolds = 10, parallel = TRUE,      family = &quot;binomial&quot;, alpha = 1, intercept = TRUE) 

Measure: Binomial Deviance 

     Lambda Measure      SE Nonzero
min 0.02369  0.4939 0.02139      65
1se 0.03132  0.5107 0.01893      16</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso_tfidf</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train_tfidf, y = train$category, nfolds = 10,      parallel = TRUE, family = &quot;binomial&quot;, alpha = 1, intercept = TRUE) 

Measure: Binomial Deviance 

     Lambda Measure      SE Nonzero
min 0.02369  0.4939 0.02139      69
1se 0.03132  0.5107 0.01893      16</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Plot lasso without cv and with cv to mark lamda.min and lamda.1se</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso_1</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Lasso penalty \n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>lasso</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lty<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>lasso</span><span class='op'>$</span><span class='va'>lambda.1se</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"blue"</span>, lty<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso_1_tfidf</span>, xvar<span class='op'>=</span><span class='st'>"lambda"</span>, main<span class='op'>=</span><span class='st'>"Lasso penalty tfidf \n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>lasso_tfidf</span><span class='op'>$</span><span class='va'>lambda.min</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"red"</span>, lty<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/abline.html'>abline</a></span><span class='op'>(</span>v<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>lasso_tfidf</span><span class='op'>$</span><span class='va'>lambda.1se</span><span class='op'>)</span>, col<span class='op'>=</span><span class='st'>"blue"</span>, lty<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-16-1.png" width="975" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso</span>,main<span class='op'>=</span><span class='st'>"Lasso penalty\n\n"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>lasso_tfidf</span>,main<span class='op'>=</span><span class='st'>"Lasso penalty tfidf\n\n"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-17-1.png" width="975" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Predict </span>
<span class='va'>lasso</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train, y = train$category, nfolds = 10, parallel = TRUE,      family = &quot;binomial&quot;, alpha = 1, intercept = TRUE) 

Measure: Binomial Deviance 

     Lambda Measure      SE Nonzero
min 0.02369  0.4939 0.02139      65
1se 0.03132  0.5107 0.01893      16</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso_tfidf</span>
</code></pre>
</div>
<pre><code>
Call:  cv.glmnet(x = dfmat_train_tfidf, y = train$category, nfolds = 10,      parallel = TRUE, family = &quot;binomial&quot;, alpha = 1, intercept = TRUE) 

Measure: Binomial Deviance 

     Lambda Measure      SE Nonzero
min 0.02369  0.4939 0.02139      69
1se 0.03132  0.5107 0.01893      16</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso</span><span class='op'>$</span><span class='va'>lambda.1se</span>
</code></pre>
</div>
<pre><code>[1] 0.03131881</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso</span><span class='op'>$</span><span class='va'>lambda.min</span>
</code></pre>
</div>
<pre><code>[1] 0.02369153</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>actual_class</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
<span class='va'>predicted_class.lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso</span>, newx<span class='op'>=</span><span class='va'>dfmat_matched</span>,s<span class='op'>=</span><span class='st'>"lambda.min"</span>, type<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span>

<span class='va'>tab_class.lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>predicted_class.lasso</span>, <span class='va'>actual_class</span><span class='op'>)</span>

<span class='va'>confusion_matrix_lasso</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>tab_class.lasso</span>, mode<span class='op'>=</span><span class='st'>"everything"</span>, positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span>


<span class='co'>##tfidf</span>
<span class='va'>lasso_tfidf</span><span class='op'>$</span><span class='va'>lambda.1se</span>
</code></pre>
</div>
<pre><code>[1] 0.03131881</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>lasso_tfidf</span><span class='op'>$</span><span class='va'>lambda.min</span>
</code></pre>
</div>
<pre><code>[1] 0.02369153</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>actual_class_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span><span class='op'>)</span>
<span class='va'>predicted_class.lasso_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>lasso_tfidf</span>,
                                       newx<span class='op'>=</span><span class='va'>dfmat_matched_tfidf</span>,s<span class='op'>=</span><span class='st'>"lambda.min"</span>,
                                       type<span class='op'>=</span><span class='st'>"class"</span><span class='op'>)</span>

<span class='va'>tab_class.lasso_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>predicted_class.lasso_tfidf</span>, <span class='va'>actual_class</span><span class='op'>)</span>

<span class='va'>confusion_matrix_lasso_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>tab_class.lasso_tfidf</span>, mode<span class='op'>=</span><span class='st'>"everything"</span>, positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span>

<span class='va'>confusion_matrix_lasso</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

                     actual_class
predicted_class.lasso covid sars
                covid   100   11
                sars      1   81
                                          
               Accuracy : 0.9378          
                 95% CI : (0.8939, 0.9675)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8748          
                                          
 Mcnemar&#39;s Test P-Value : 0.009375        
                                          
            Sensitivity : 0.9901          
            Specificity : 0.8804          
         Pos Pred Value : 0.9009          
         Neg Pred Value : 0.9878          
              Precision : 0.9009          
                 Recall : 0.9901          
                     F1 : 0.9434          
             Prevalence : 0.5233          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5751          
      Balanced Accuracy : 0.9353          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
<div class="sourceCode">
<pre><code><span class='va'>confusion_matrix_lasso_tfidf</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

                           actual_class
predicted_class.lasso_tfidf covid sars
                      covid   100   11
                      sars      1   81
                                          
               Accuracy : 0.9378          
                 95% CI : (0.8939, 0.9675)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8748          
                                          
 Mcnemar&#39;s Test P-Value : 0.009375        
                                          
            Sensitivity : 0.9901          
            Specificity : 0.8804          
         Pos Pred Value : 0.9009          
         Neg Pred Value : 0.9878          
              Precision : 0.9009          
                 Recall : 0.9901          
                     F1 : 0.9434          
             Prevalence : 0.5233          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5751          
      Balanced Accuracy : 0.9353          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
</div>
<p>The best model in the end retains 65 variables. If we used tf-idf weighting, the best model retains 69 of the 1219 variables. That is great way to reduce the irrelevant features. We can have a look at some of these variables using the <code>vip</code>package. VIP ranks based on their importance scores.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/koalaverse/vip/'>vip</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/vip/man/vip.html'>vip</a></span><span class='op'>(</span><span class='va'>lasso_tfidf</span>, <span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-19-1.png" width="975" /></p>
</div>
<p>Let’s see if this this variables are also the main features in the ridge model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/pkg/vip/man/vip.html'>vip</a></span><span class='op'>(</span><span class='va'>ridge_min_tfidf</span>, <span class='fl'>10</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-20-1.png" width="975" /></p>
</div>
<h1 id="elastic-net">Elastic net</h1>
<p>In my experience with text data, I found elastic net regression having problems with the matrix format of the dfm objects resulted from quanteda. I will have to convert the matrix formats to data frames.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>da_train</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>category<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                  <span class='fu'><a href='https://quanteda.io/reference/convert.html'>convert</a></span><span class='op'>(</span><span class='va'>dfmat_train</span>, to<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span> 

<span class='va'>da_train_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>category<span class='op'>=</span><span class='va'>train</span><span class='op'>$</span><span class='va'>category</span>, 
                        <span class='fu'><a href='https://quanteda.io/reference/convert.html'>convert</a></span><span class='op'>(</span><span class='va'>dfmat_train_tfidf</span>, to<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dfmat_train</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_train</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12121</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>da_train</span> <span class='op'>&lt;-</span> <span class='va'>da_train</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'>#the document identifier variable should be removed</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_train</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12120</code></pre>
<div class="sourceCode">
<pre><code><span class='co'>## The tfidf version </span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dfmat_train_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_train_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12121</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>da_train_tfidf</span> <span class='op'>&lt;-</span> <span class='va'>da_train_tfidf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'>#the document identifier variable should be removed</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_train_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12120</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>da_train_xmatrix</span> <span class='op'>&lt;-</span> <span class='va'>da_train</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span> 
<span class='va'>da_train_xdf</span> <span class='op'>&lt;-</span> <span class='va'>da_train</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>#for the tf-idf pre-processed data </span>

<span class='va'>da_train_xmatrix_tfidf</span> <span class='op'>&lt;-</span> <span class='va'>da_train_tfidf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span> 

<span class='va'>da_train_xdf_tfidf</span> <span class='op'>&lt;-</span> <span class='va'>da_train_tfidf</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='va'>da_test_match</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>category<span class='op'>=</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span>, <span class='fu'><a href='https://quanteda.io/reference/convert.html'>convert</a></span><span class='op'>(</span><span class='va'>dfmat_matched</span>, to<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span> 

<span class='va'>da_test_match</span> <span class='op'>&lt;-</span> <span class='va'>da_test_match</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>]</span> 
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_test_match</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12120</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>da_test_xmatrix</span> <span class='op'>&lt;-</span> <span class='va'>da_test_match</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span> 
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dfmat_matched</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_test_xmatrix</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
<div class="sourceCode">
<pre><code><span class='co'># Do the same for the tfidf data</span>

<span class='va'>da_test_match_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span>category<span class='op'>=</span><span class='va'>test</span><span class='op'>$</span><span class='va'>category</span>, <span class='fu'><a href='https://quanteda.io/reference/convert.html'>convert</a></span><span class='op'>(</span><span class='va'>dfmat_matched_tfidf</span>, to<span class='op'>=</span><span class='st'>"data.frame"</span><span class='op'>)</span><span class='op'>)</span> 

<span class='va'>da_test_match_tfidf</span> <span class='op'>&lt;-</span> <span class='va'>da_test_match_tfidf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>]</span> <span class='co'>#the document identifier variable should be removed</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_test_match_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12120</code></pre>
<div class="sourceCode">
<pre><code><span class='va'>da_test_xmatrix_tfidf</span> <span class='op'>&lt;-</span> <span class='va'>da_test_match_tfidf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>  <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='op'>)</span> <span class='co'># remove the dependent variable</span>

<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>dfmat_matched_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
<div class="sourceCode">
<pre><code><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>da_test_xmatrix_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 12119</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'># Fit elastic net regression with 10 different alpha values from 0 to 1</span>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>223</span><span class='op'>)</span>
<span class='va'>y</span><span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>da_train_xdf</span><span class='op'>$</span><span class='va'>category</span><span class='op'>==</span><span class='st'>"covid"</span>, <span class='st'>"1"</span>, <span class='st'>"0"</span><span class='op'>)</span> <span class='co'># convert to numeric labels</span>
                       
<span class='va'>cv_glmnet_10_roc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>da_train_xdf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, 
                          y <span class='op'>=</span> <span class='va'>y</span>, type.measure<span class='op'>=</span><span class='st'>"auc"</span>, method<span class='op'>=</span><span class='st'>"glmnet"</span>,
                          family<span class='op'>=</span><span class='st'>"binomial"</span>, 
                          traControl<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"cv"</span>, number<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>,
                          parallel<span class='op'>=</span><span class='cn'>TRUE</span>,
                          tuneLength<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span> <span class='co'># I will use 10 different alpha values between 0 and 1</span>

<span class='va'>x</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Time difference of -24.38943 mins</code></pre>
<div class="sourceCode">
<pre><code><span class='co'>#tfidf</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>223</span><span class='op'>)</span>
<span class='va'>cv_glmnet_10_roc_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>da_train_xdf_tfidf</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, 
                                y <span class='op'>=</span> <span class='va'>y</span>, type.measure<span class='op'>=</span><span class='st'>"auc"</span>, method<span class='op'>=</span><span class='st'>"glmnet"</span>,
                                family<span class='op'>=</span><span class='st'>"binomial"</span>,
                              traControl<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"cv"</span>,number<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>, 
                                parallel<span class='op'>=</span><span class='cn'>TRUE</span>,
                                tuneLength<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span> 

<span class='va'>x</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.time</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Time difference of -16.83805 mins</code></pre>
</div>
Let’s visualize the two models
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cv_glmnet_10_roc</span><span class='op'>)</span>
</code></pre>
</div>
<img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-26-1.png" width="975" />
<div class="sourceCode">
<pre><code><span class='co'>#Tf-idf</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>cv_glmnet_10_roc_tfidf</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="2020-12-09-documentclassification-using-regularized-models_files/figure-html5/unnamed-chunk-26-2.png" width="975" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre><code><span class='co'>## Predict using the belastic model cv_glmnet_50</span>
<span class='va'>predicted_class.elastic_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv_glmnet_10_roc</span>, 
                                      <span class='va'>da_test_xmatrix</span>, 
                                      <span class='va'>cv_glmnet_10_roc</span><span class='op'>$</span><span class='va'>lamda.min</span>, type<span class='op'>=</span><span class='st'>"raw"</span><span class='op'>)</span>

<span class='va'>predicted_class.elastic_10</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>predicted_class.elastic_10</span><span class='op'>==</span><span class='fl'>0</span>, 
                                               <span class='st'>"sars"</span>, <span class='st'>"covid"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>confusion_mat_elastic_net</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>predicted_class.elastic_10</span>, 
                                      <span class='va'>actual_class</span>, mode<span class='op'>=</span><span class='st'>"everything"</span>,
                                      positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span> 

<span class='co'>#Predict the tfidf weighted data</span>

<span class='va'>predicted_class.elastic_10_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>cv_glmnet_10_roc_tfidf</span>,
                                            <span class='va'>da_test_xmatrix_tfidf</span>,
                                            <span class='va'>cv_glmnet_10_tfidf</span><span class='op'>$</span><span class='va'>lamda.min</span>, 
                                            type<span class='op'>=</span><span class='st'>"raw"</span><span class='op'>)</span>

<span class='va'>predicted_class.elastic_10_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>predicted_class.elastic_10_tfidf</span><span class='op'>==</span><span class='fl'>0</span>, <span class='st'>"sars"</span>, <span class='st'>"covid"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>confusion_mat_elastic_net_tfidf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/confusionMatrix.html'>confusionMatrix</a></span><span class='op'>(</span><span class='va'>predicted_class.elastic_10_tfidf</span>, 
                                            <span class='va'>actual_class</span>, 
                                            mode<span class='op'>=</span><span class='st'>"everything"</span>, positive<span class='op'>=</span><span class='st'>"covid"</span><span class='op'>)</span> 

<span class='va'>confusion_mat_elastic_net</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction covid sars
     covid   100   11
     sars      1   81
                                          
               Accuracy : 0.9378          
                 95% CI : (0.8939, 0.9675)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8748          
                                          
 Mcnemar&#39;s Test P-Value : 0.009375        
                                          
            Sensitivity : 0.9901          
            Specificity : 0.8804          
         Pos Pred Value : 0.9009          
         Neg Pred Value : 0.9878          
              Precision : 0.9009          
                 Recall : 0.9901          
                     F1 : 0.9434          
             Prevalence : 0.5233          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5751          
      Balanced Accuracy : 0.9353          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
<div class="sourceCode">
<pre><code><span class='va'>confusion_mat_elastic_net_tfidf</span>
</code></pre>
</div>
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction covid sars
     covid   100   11
     sars      1   81
                                          
               Accuracy : 0.9378          
                 95% CI : (0.8939, 0.9675)
    No Information Rate : 0.5233          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.8748          
                                          
 Mcnemar&#39;s Test P-Value : 0.009375        
                                          
            Sensitivity : 0.9901          
            Specificity : 0.8804          
         Pos Pred Value : 0.9009          
         Neg Pred Value : 0.9878          
              Precision : 0.9009          
                 Recall : 0.9901          
                     F1 : 0.9434          
             Prevalence : 0.5233          
         Detection Rate : 0.5181          
   Detection Prevalence : 0.5751          
      Balanced Accuracy : 0.9353          
                                          
       &#39;Positive&#39; Class : covid           
                                          </code></pre>
</div>
<h1 id="final-remarks">Final remarks</h1>
<p>Notice, Lasso and Elastic net models gave us superior prediction performances. A model with a sensitivity of 99%, and a specificity of 88%, and precision of more than 90% is extraordinarily superior to me! Sensitivity and specificity are not affected by prevalence. But, precision(positive predictive value) and negative predictive values are influenced by prevalence.It is possible to calculate confidence intervals for sensitivity and specificity. But, I will not do that here. Since the prevalence of covid abstracts is high(52%), the precission of my predictive models are all high. This may not be the case if your model is dealing with rare cases.</p>
<p><a href="https://bradleyboehmke.github.io/HOML/">This book</a> by <em>Bradley Boehmke &amp; Brandon Greenwell is a good reference to learn about machine learning</em>. It is freely available. But, you can also buy a hard copy. It is one of my favorite machine learning books.</p>
<h1 id="contact">Contact</h1>
<p><a href="https://twitter.com/MihiretuKebede1">@MihiretuKebede1</a></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
